# 웹브라우저가 메시지를 만든다

## 웹브라우저가 메시지를 만들고 웹서버로 전송하기 위해서는 크게 아래 4가지부분에 대해서 알아야 됩니다.

1. HTTP 리퀘스트 메시지를 작성하는 과정에 대해서 살펴보겠습니다. 
- 사용자가 브라우저에 URL을 입력하면, 그 URL을 해독하는 곳부터 브라우저의 동작이 시작됩니다.

URL의 의미에따라 리퀘스트 메시지를 만듭니다.

2. 웹 서버의 IP 주소를 DNS 서버에 조회합니다.
- 기본적으로 브라우저는 네트워크 송출기능이 없습니다. 따라서 메시지를 만들면 OS에 의뢰해서 웹 서버에 송신하는데, 이때 메시지를 넘기는 상대의 IP의 주소를 OS에 통지해야 합니다. 그러면 여기에서 브라우저는 웹 서버의 IP 주소를 조사합니다.  URL에는 웹서버의 도메인명이 쓰여있고, 그 이름을 DNS 서버에 조회하여 IP 주소를 조사합니다.

3. 전세계의 DNS 서버가 연대합니다.
- DNS 서버는 전 세계에 수만 대가 있으며, 그것들이 연대하여 IP 주소를 조사합니다.

4. 프로토콜 스택에 메시지 송신을 의뢰합니다.
- IP 주소를 조사하면 메시지를 웹 서버에 송신하도록 OS에 의뢰합니다. OS에 의뢰는 쉽진 않고 대단히 세밀합니다. 따라서 그 규칙을 따라야 합니다.  사실 프로그래머가 아니라면 그 규칙에 정통할 필요는 없지만 분위기를 아는 것은 나중에 프로그래밍에 크게 도움이 됩니다.

### Socket 라이브러리가 IP 주소를 찾는 기능을 제공합니다.

IP 주소를  조사하는 방법은 보통 DNS 서버에 ‘www.lab.cyber.co.kr’이라는 서버의 IP 주소를 찾아주세요라고 요청을 하면 DNS 서버가 그 서버의 IP 주소는  ‘xxxx.xxxx.xxxx.xxxx’입니다라고 응답을 해준다고만 알고 있었습니다.

사실 더 깊게 들어가면 DNS 서버에 조회한다는 것은 DNS 서버에 조회 메시지를 보내고, 거기에서 반송되는 응답 메시지를 받는 것을 의미합니다. 이것은 DNS 서버에 대해 클라이언트로 동작한다는 것을 의미하기도 합니다. 이 DNS 클라이언트에 해당하는 것을 DNS 리졸버 또는 단순히 리졸버라고 부릅니다.

그리고  DNS의 원리를 사용하여 IP 주소를 조사하는 것을 네임 리졸루션(이름 확인)이라고 하는데, 이 리졸루션을 실행하는 것이 리졸버입니다.

리졸버의 실체는 Socket 라이브러리에 들어있는 부품화한 프로그램입니다.  다양한 라이브러리가 세상에 존재하지만 Socket 라이브러리는 OS에 포함되어 있는 네트워크 기능을 어플리케이션에서 호출하기 위한 부품을 모아놓은 것입니다. 리졸버는 그 속에 들어있는 프로그램 부품의 하나입니다.

핀트는 Socket 라이브러리는 네트워크 기능을 호출하기 위한 프로그램의 부품집을 의미합니다.

리졸버를 호출하는 방법을 C로 작성한 네트워크 어플리케이션 소스코드로 살펴보면 아래와 같습니다.

```c
<어플리케이션 프로그램의 이름> (<매개변수>)
{
	
		<메모리영역> = gethostbyname("www.lab.cyber.co.kr");

		<HTTP 메시지 송신>

}
```

브라우저 프로그램에 위의 코드처럼 리졸버를 호출하면 리졸버가 DNS 서버에 조회 메시지를 보내고, DNS 서버에서 응답 메시지가 돌아옵니다. 이 응답 메시지 속에 IP 주소가 포함되어 있으므로 리졸버는 이것을 추출하여 브라우저에서 지정한 메모리 영역에 써넣습니다.  이것으로 IP 주소를 조회하는 동작은 끝났습니다.

결국 브라우저가 웹 서버에 메시지를 보낼때는 이 메모리 영역에서 IP 주소를 추출하여 HTTP의 리퀘스트 메시지와 함께 OS에 건네주어 송신을 의뢰할 뿐입니다.
