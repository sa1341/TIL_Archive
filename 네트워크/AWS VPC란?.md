# AWS VPC란?

AWS EC2 인스턴스들을 사용하면서 VPC를 설정하여 내부 EC2 인스턴스끼리 통신이 가능하도록 설정한적이 있었습니다.

그때는 그냥 이렇게 설정하면 서로 통신을 할 수 있구나 하고 넘어갔지만 다시 VPC 개념에 대해서 구글링을 통해 알아봤습니다.

VPC는 Virtual Private Cloud의 약자로써 사용자의 AWS 계정 전용 가상 네트워크를 의미합니다.

요약하면 사용자가 정의하는 가상의 네트워크입니다. VPC를 통해 인스턴스가 속하는 네트워크를 구분하여 각 네트워크에 맞는 설정을 부여할 수 있습니다. 

만일 VPC 없이 인스턴스를 생성한다면 아래 이미지처럼 인스턴스끼리의 구분 없는 연결로 인해 시스템의 복잡도가 증가할 것입니다.

![Untitled Diagram drawio (2)](https://user-images.githubusercontent.com/22395934/148957577-59362459-b150-4c2d-bd29-6af17bbbe134.png)


VPC를 적용하면 아래와 같이 인스턴스가 VPC에 속함으로써 네트워크를 구분할 수 있고 VPC 별로 필요한 설정을 통해 인스턴스에 네트워크 설정을 적용할 수 있습니다.

![Untitled Diagram drawio (4)](https://user-images.githubusercontent.com/22395934/148958443-d35e761a-4c56-44ec-b3d9-e5ae4e4428e7.png)


## VPC 구성요소

VPC는 독립된 하나의 네트워크를 구성하기 위한 가장 큰 단위입니다. 각 region에 종속되며 RFC1918이라는 사설 IP 대역에 맞추어 설계해야 한다. 

VPC에서 사용하는 사설 IP 대역은 아래와 같습니다.

- 10.0.0.0 ~ 10.255.255.255(10/8 prefix)
- 172.16.0.0 ~ 172.31.255.255(182.16/12 prefix)
- 192.168.0.0 ~ 192.168.255.255(192.168/16 prefix)

각각의 대역폭마다 고정되어 있는 `prefix`가 다릅니다.

VPC에서 한번 설정된 IP 대역은 수정할 수 없으며 각각의 VPC는 독립적이기 때문에 서로 통신할 수 없습니다. 통신을 하기 위해서는 VPC 피어링 서비스를 통해 VPC 간에 트래픽 라우팅을 할 수 있도록 설정이 필요합니다.


하나의 Region에는 여러개의 `Availability Zone`이 있습니다. 각 AZ에는 EC2, RDS 등 내가 원하는 AWS 리소스들을 배치할 수 있습니다. 
만약 하나의 AZ에 장애가 발생하게 될 경우, 다른 AZ를 사용할 수도 있습니다.

VPC를 생성할 때 어떤 Region에 생성할지를 결정해야하며 이때 모든 AZ를 포함하게 됩니다. VPC 별로 네트워크를 구성할 수 있고, VPC별로 네트워크 설정을 달리할 수도 있습니다. 

#### 참조 블로그: https://jbhs7014.tistory.com/164


