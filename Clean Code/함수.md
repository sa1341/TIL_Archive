## 함수

오랜만에 클린코드 책을 읽으면서 내가 회사에서 함수를 누가보더라도 깔끔하게 작성하게 되는지 되돌아보는 시간이 되었습니다. 

클린코드 책에서는 함수는 한가지를 해야한다고 강조합니다. 그 한가지를 잘해야하고, 그한 가지만을 해야한다고 합니다.

잘 작성된 함수는 무엇을 의미할까요... 항상 그 `한 가지`가 무엇인지 알기가 어렵다는 점입니다. 

아래 엄청 복잡한 메서드가 정의되어 있습니다. 보기만해도 머리아프네요.

```java
public static String testtableHtml(PageData pageData,
boolean includeSuiteSetup) throw Exception {

    WikiPage wikiPage = pageData.getWikiPage();
    StringBuffer buffer = new StringBuffer();

    if (pageData.hasAttribute("Test")) {
        if (includeSuiteSetup) {
            WikiPage suitSetup = PageCrawlerImpl.getInheritedPage(SuiteResponder.SUITE_SETUP_NAME, wikiPage
            );
            if (suiteSetup != null) {
                WikiPagePath pagePath -
                 suiteSetup.getPageCrawler().getFullPath(suiteSetup);
                 String pagePathName = PathParser.render(pagePath);
                 buffer.append("!include -setup .")
                       .append(pagePathName)
                       .append("\n");
            }
        } 
    .....
    }
}
```

클린코드 책에는 위의 함수 코드라인 길이의 2배정도 되었는데... 너무 길어서 중간에 생략했습니다. 핀트는 해당 도메인에 대한 지식이 없으면 너무 이해하기 난해한 코드라는 점입니다. 추상화 수준도 너무 다양하고, 코드 길이가 너무 깁니다. 두 겹으로 중첩된 if문은 이상한 플래그를 확인하고, 이상한 문자열을 사용하며, 이상한 함수를 호출합니다.

하지만 메서드 몇개를 추출하고, 이름 몇개를 변경하고, 구조를 조금 변경했더니 아래 목록이 나왔습니다. 아래 함수는 함수 의도를 코드 9줄로 표현합니다.

```java
public static String testtableHtml(PageData pageData,
boolean includeSuiteSetup) throw Exception {

    boolean isTestPage = pageData.getWikiPage();
    if (isTestPage) {
        WikiPage testPage = pageData.getWikiPage();
        StringBuffer newPageContent = new StringBuffer();
        includeSetupPages(testPage, newPageContent, isSuite);
        newPageContent.append(pageData.getContent());
        includeTearDownPages(testPage, newPageContent, isSuite);
    }
    return pageData.getHtml();
}
```

FitNess에 익숙하지 않은 이상 코드를 100% 이해하기 어렵습니다. 대충 내용만 봤을 때 설정 페이지와 해제 페이지를 테스트 페이지에 넣은 후 해당 테스트 페이지를 HTML로 렌더링한다는 사실을 집작할 수 있습니다. 아까보다 함수가 읽기 쉽고 이해하기 쉬운 이유가 무엇일까요? 

일단은 작게 만드는 것이 핀트입니다. 프로그래밍만 수십년간 했던 개발자들도 함수는 작으면 작을수록 좋다고 합니다. 예전 80년대에는 함수가 한 화면을 넘어가면 안된다고 하였고, 지금은 20줄도 길다고 합니다. 제 생각에도 10줄이내에 작성한 함수가 가독성도 유지보수적인 측면에서 좋다고 생각합니다.

함수는 항상 하나의 기능만을 잘 수행할 수 있도록 작성하고, 잘게 쪼개는 것이 중요하다고 생각합니다.





