롤링업데이트는 매우 일반적인 전략입니다.
롤링업데이트 동작을 조정하는 데 사용되는 매개변수는 maxUnavailable과 maxSurge 입니다.

## maxUnavailable 설정

maxUnavailable 매개변수는 롤링업데이트 과정에서 사용 불가능한 파드의 최대 개수를 설정합니다.
절댓값 또는 백분율로 설정이 가능하며, 일반적으로 백분율을 사용하는 것이 디플로이먼트에서 원하는 복제본 수에 관계없이 사용 불가능한 파드의 수를 올바르게 적용할 수 있기 때문에 대부분의 서비스에 적합한 접근 방식 입니다.

본질적으로 maxUnavailable 매개변수는 롤링 업데이트 진행 속도를 조정하는데 도움을 줍니다.
만약 maxUnavailable 값을 50%로 설정하면 롤링업데이트는 기존 레플리카셋을 2개의 복제본으로 축소됩니다.

그 후 롤링업데이트는 새로운 레플리카셋을 최대 2개의 복제본으로 확장해 축소로 제거된 파드를 대체해 총 4개의 복제본을 유지합니다.
그런 다음 기존 레플리카셋을 0개의 복제본으로 축소해 총 2개의 신규 복제본을 유지합니다. 
결국엔 50%로 설정하면 롤아웃이 4단계로 완료되며, 롤아웃 과정에서 50%의 가용률만 갖게 됩니다.


## maxSurge 설정

위에서 설명한 maxUnavailable과 마찬가지로 maxSurge는 특정 값이나 백분률로 지정 가능합니다.
maxSurge 매개변수는 롤아웃을 수행하고자 생성할 수 있는 추가 리소스의 양을 제어합니다. 
예를 들어서 10개의 복제본이 있는 서비스가 있다고 가정해보겠습니다.
maxUnavailable을 0으로 설정하고 maxSurge를 20%로 설정했습니다. 롤아웃 수행 시 첫번째 단계는 새로운 레플리카셋에서 2개의 복제본을 추가로 생성해 서비스에서 총 12개의 복제본을 유지합니다.

그런 다음 이전 레플리카셋을 8개로 축소해 서비스에서 총 10개의 복제본을 유지합니다. 이러한 과정을 롤아웃이 완료될때까지 진행합니다. 어느시점에서나 서비스 용량은 최소 100%를 유지하며 최대 추가 리소스는 전체 리소스의 20%로 제합합니다.

> maxSurge를 100%로 설정하는 것은 블루/그린 배포와 동일합니다. 디플로이먼트 컨트롤러는 먼저 새로운 버전을 이전 버전의 100%까지 확장합니다. 이후 새로운 버전이 안정적으로 동작하면 즉시 이전 버전을 0%로 축소해 업데이트를 완료합니다.
